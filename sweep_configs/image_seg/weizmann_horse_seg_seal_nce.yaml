name: weizmann_horse_seg_seal_nce
program: allennlp
command:
- ${program}
- train-with-wandb
- model_configs/image_seg/weizmann_horse_seg_seal_nce.jsonnet
- --include-package=structured_prediction_baselines
- --wandb-entity=score-based-learning
- --wandb-project=segmentation
- --wandb-tags=task@image_seg,dataset@weizmann_horse
- ${args}
- --file-friendly-logging
description: Train tasknn using cross-entropy and energy.
  The score-nn will be trained using NCE.
  The samples are taken as discrete samples from the tasknn output.
method: bayes
metric:
  goal: maximize
  name: validation/best_seg_iou
parameters:
  env.batch_size:
    value: 8
  trainer.optimizer.optimizers.task_nn.lr:
    distribution: log_uniform
    max: -1.6
    min: -4.6
  trainer.optimizer.optimizers.score_nn.lr:
    distribution: log_uniform
    max: -1.6
    min: -4.6
  trainer.num_steps.task_nn:
    distribution: int_uniform
    max: 5
    min: 1
  trainer.num_steps.score_nn:
    distribution: int_uniform
    max: 10
    min: 1
  env.score_loss_weight:
    distribution: log_uniform
    max: 2.3
    min: -6.9
  model.loss_fn.num_samples:
    distribution: int_uniform
    max: 1000
    min: 50